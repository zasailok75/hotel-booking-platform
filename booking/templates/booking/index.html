<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hotel Booking Platform</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .hotel-card {
            transition: transform 0.3s;
            margin-bottom: 20px;
        }
        .hotel-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }
        .search-container {
            background-color: #f8f9fa;
            padding: 30px;
            border-radius: 10px;
            margin-bottom: 30px;
        }
        .banner {
            background: linear-gradient(rgba(0,0,0,0.5), rgba(0,0,0,0.5)), url('https://images.unsplash.com/photo-1566073771259-6a8506099945?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80');
            background-size: cover;
            background-position: center;
            color: white;
            padding: 100px 0;
            margin-bottom: 50px;
        }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container">
            <a class="navbar-brand" href="#">Hotel Booking</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link active" href="#">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">Hotels</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">My Bookings</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">Login</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="banner text-center">
        <div class="container">
            <h1 class="display-4">Find Your Perfect Stay</h1>
            <p class="lead">Discover amazing hotels at the best prices</p>
        </div>
    </div>

    <div class="container">
        <div class="search-container">
            <h2 class="mb-4">Search Hotels</h2>
            <form id="search-form">
                <div class="row g-3">
                    <div class="col-md-3">
                        <label for="city" class="form-label">City</label>
                        <input type="text" class="form-control" id="city" placeholder="Enter city name">
                    </div>
                    <div class="col-md-2">
                        <label for="check-in" class="form-label">Check-in Date</label>
                        <input type="date" class="form-control" id="check-in">
                    </div>
                    <div class="col-md-2">
                        <label for="check-out" class="form-label">Check-out Date</label>
                        <input type="date" class="form-control" id="check-out">
                    </div>
                    <div class="col-md-3">
                        <div class="form-check mt-4">
                            <input class="form-check-input" type="checkbox" id="unfilled-only">
                            <label class="form-check-label" for="unfilled-only">
                                Show only hotels with available rooms
                            </label>
                        </div>
                    </div>
                    <div class="col-md-2 d-flex align-items-end">
                        <button type="submit" class="btn btn-primary w-100">Search</button>
                    </div>
                </div>
            </form>
        </div>

        <h2 class="mb-4">Popular Hotels</h2>
        <div class="row" id="hotels-container">
            <!-- Hotel cards will be loaded here -->
            <div class="col-md-4">
                <div class="card hotel-card">
                    <img src="https://images.unsplash.com/photo-1551882547-ff40c63fe5fa?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60" class="card-img-top" alt="Hotel">
                    <div class="card-body">
                        <h5 class="card-title">Oceanview Resort</h5>
                        <p class="card-text"><i class="bi bi-geo-alt"></i> Miami, FL</p>
                        <p class="card-text">Experience luxury beachfront accommodations with stunning ocean views.</p>
                        <div class="d-flex justify-content-between align-items-center">
                            <span class="text-primary fw-bold">$199/night</span>
                            <a href="#" class="btn btn-outline-primary">View Rooms</a>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card hotel-card">
                    <img src="https://images.unsplash.com/photo-1564501049412-61c2a3083791?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60" class="card-img-top" alt="Hotel">
                    <div class="card-body">
                        <h5 class="card-title">Mountain Inn</h5>
                        <p class="card-text"><i class="bi bi-geo-alt"></i> Denver, CO</p>
                        <p class="card-text">Cozy mountain retreat with breathtaking views and outdoor activities.</p>
                        <div class="d-flex justify-content-between align-items-center">
                            <span class="text-primary fw-bold">$149/night</span>
                            <a href="#" class="btn btn-outline-primary">View Rooms</a>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card hotel-card">
                    <img src="https://images.unsplash.com/photo-1566073771259-6a8506099945?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60" class="card-img-top" alt="Hotel">
                    <div class="card-body">
                        <h5 class="card-title">City Center Hotel</h5>
                        <p class="card-text"><i class="bi bi-geo-alt"></i> New York, NY</p>
                        <p class="card-text">Modern accommodations in the heart of the city with easy access to attractions.</p>
                        <div class="d-flex justify-content-between align-items-center">
                            <span class="text-primary fw-bold">$249/night</span>
                            <a href="#" class="btn btn-outline-primary">View Rooms</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <footer class="bg-dark text-white mt-5 py-4">
        <div class="container">
            <div class="row">
                <div class="col-md-6">
                    <h5>Hotel Booking Platform</h5>
                    <p>Find the perfect hotel for your next trip.</p>
                </div>
                <div class="col-md-3">
                    <h5>Quick Links</h5>
                    <ul class="list-unstyled">
                        <li><a href="#" class="text-white">Home</a></li>
                        <li><a href="#" class="text-white">Hotels</a></li>
                        <li><a href="#" class="text-white">My Bookings</a></li>
                    </ul>
                </div>
                <div class="col-md-3">
                    <h5>Contact</h5>
                    <ul class="list-unstyled">
                        <li>Email: info@hotelbooking.com</li>
                        <li>Phone: +1 (123) 456-7890</li>
                    </ul>
                </div>
            </div>
            <hr>
            <div class="text-center">
                <p class="mb-0">Â© 2023 Hotel Booking Platform. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Initialize date inputs with today and tomorrow
        document.addEventListener('DOMContentLoaded', function() {
            const today = new Date();
            const tomorrow = new Date(today);
            tomorrow.setDate(tomorrow.getDate() + 1);
            
            document.getElementById('check-in').valueAsDate = today;
            document.getElementById('check-out').valueAsDate = tomorrow;
            
            // Load initial hotels
            fetchHotels();
            
            // Form submission handler
            document.getElementById('search-form').addEventListener('submit', function(e) {
                e.preventDefault();
                const city = document.getElementById('city').value;
                const checkIn = document.getElementById('check-in').value;
                const checkOut = document.getElementById('check-out').value;
                const unfilledOnly = document.getElementById('unfilled-only').checked;
                
                // Display available cities to help users
                if (city && !isAvailableCity(city)) {
                    alert('Try searching for these available cities:\n\nUS Cities: Toledo, Boise City, Durham, Los Angeles, Plano\n\nIndian Cities: Mumbai, Delhi, Bangalore, Hyderabad, Chennai, Kolkata, Pune, Jaipur, and many more!');
                }
                
                // Make API call to search hotels
                fetchHotels(city, checkIn, checkOut, unfilledOnly);
            });
        });
        
        // Function to check if a city is available in our database
        function isAvailableCity(city) {
            const availableCities = [
                // US Cities
                'toledo', 'boise city', 'durham', 'los angeles', 'plano',
                // Indian Cities/States
                'mumbai', 'delhi', 'bangalore', 'hyderabad', 'chennai', 'kolkata', 
                'ahmedabad', 'pune', 'jaipur', 'lucknow', 'kanpur', 'nagpur', 
                'indore', 'thane', 'bhopal', 'visakhapatnam', 'patna', 'vadodara', 
                'ghaziabad', 'ludhiana', 'agra', 'nashik', 'faridabad', 'meerut', 
                'rajkot', 'varanasi', 'srinagar', 'aurangabad', 'dhanbad', 'amritsar', 
                'navi mumbai', 'allahabad', 'ranchi', 'howrah', 'coimbatore', 'jabalpur', 
                'gwalior', 'vijayawada', 'jodhpur', 'madurai', 'raipur', 'kota', 
                'chandigarh', 'guwahati', 'solapur', 'hubli-dharwad', 'mysore'
            ];
            return availableCities.some(c => city.toLowerCase().includes(c) || c.includes(city.toLowerCase()));
        }
        
        // Function to fetch hotels from API
        function fetchHotels(city = '', checkIn = '', checkOut = '', unfilledOnly = false) {
            let apiUrl = '/api/hotels/';
            let params = [];
            
            if (city) {
                params.push(`search=${encodeURIComponent(city)}`);
            }
            
            if (checkIn && checkOut && unfilledOnly) {
                params.push(`check_in_date=${encodeURIComponent(checkIn)}`);
                params.push(`check_out_date=${encodeURIComponent(checkOut)}`);
                params.push('unfilled_only=true');
            }
            
            if (params.length > 0) {
                apiUrl += '?' + params.join('&');
            }
            
            console.log('Fetching hotels from:', apiUrl);
            
            fetch(apiUrl)
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Network response was not ok');
                    }
                    return response.json();
                })
                .then(data => {
                    console.log('API response:', data);
                    displayHotels(data.results || data);
                })
                .catch(error => {
                    console.error('Error fetching hotels:', error);
                    document.getElementById('hotels-container').innerHTML = 
                        `<div class="col-12 text-center"><p>Error loading hotels. Please try again later.</p></div>`;
                });
        }
        
        // Function to display hotels
        function displayHotels(hotels) {
            const container = document.getElementById('hotels-container');
            
            if (hotels.length === 0) {
                container.innerHTML = `<div class="col-12 text-center"><p>No hotels found matching your criteria.</p></div>`;
                return;
            }
            
            let hotelsHTML = '';
            
            hotels.forEach(hotel => {
                hotelsHTML += `
                <div class="col-md-4">
                    <div class="card hotel-card">
                        <img src="https://images.unsplash.com/photo-1566073771259-6a8506099945?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60" class="card-img-top" alt="${hotel.name}">
                        <div class="card-body">
                            <h5 class="card-title">${hotel.name}</h5>
                            <p class="card-text"><i class="bi bi-geo-alt"></i> ${hotel.city}</p>
                            <p class="card-text">${hotel.description || 'Comfortable accommodations in a great location.'}</p>
                            <div class="d-flex justify-content-between align-items-center">
                                <span class="text-primary fw-bold">$${hotel.price_per_night || '199'}/night</span>
                                <a href="/hotels/${hotel.id}/rooms/" class="btn btn-outline-primary">View Rooms</a>
                            </div>
                        </div>
                    </div>
                </div>`;
            });
            
            container.innerHTML = hotelsHTML;
        }
    </script>
</body>
</html>